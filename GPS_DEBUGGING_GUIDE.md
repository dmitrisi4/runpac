# Руководство по отладке GPS-трекинга

## Проблема
Кнопка "Start Run" не запускает трекинг или данные не сохраняются в историю при нажатии "Stop".

## Внесенные исправления

### 1. Ослаблены фильтры GPS
- **Точность**: увеличена с 20м до 50м
- **Максимальная скорость**: увеличена с 15 м/с до 25 м/с
- **Минимальное расстояние**: уменьшено с 5м до 2м
- **Таймаут**: увеличен с 5 до 10 секунд

### 2. Добавлена отладочная информация
Теперь в консоли браузера отображаются:
- Статус запуска GPS-трекинга
- Каждое GPS-обновление с координатами и точностью
- Принятые и отфильтрованные точки
- Информация о сохранении данных
- Детальные ошибки геолокации

## Как отладить проблему

### Шаг 1: Откройте консоль браузера
1. Нажмите F12 или Ctrl+Shift+I (Cmd+Option+I на Mac)
2. Перейдите на вкладку "Console"

### Шаг 2: Проверьте разрешения
1. Убедитесь, что браузер запрашивает разрешение на геолокацию
2. Разрешите доступ к местоположению
3. Проверьте настройки браузера (должна быть включена геолокация)

### Шаг 3: Тестирование
1. Нажмите "Start Run"
2. Проверьте консоль на сообщения:
   - `Starting GPS tracking...`
   - `Geolocation supported, requesting position...`
   - `GPS update: lat=..., lng=..., accuracy=...`
   - `GPS point accepted: lat=..., lng=...`

### Шаг 4: Анализ проблем

#### Если нет GPS-обновлений:
- Проверьте разрешения геолокации
- Убедитесь, что вы находитесь не в помещении (слабый GPS-сигнал)
- Попробуйте обновить страницу и повторить

#### Если точки фильтруются:
- Сообщения типа `GPS point filtered: accuracy 60m > 50m`
- Попробуйте выйти на улицу для лучшего сигнала
- Подождите несколько минут для стабилизации GPS

#### Если данные не сохраняются:
- Проверьте сообщения при остановке:
  - `Current path length: 0` - означает, что точки не записались
  - `Missing start time` - проблема с инициализацией
  - `Empty path` - GPS-точки не прошли фильтрацию

## Временное решение
Если GPS не работает, используйте кнопку "Simulate Run" для тестирования функции сохранения истории.

## Возможные причины проблем

1. **Отсутствие разрешений геолокации**
2. **Слабый GPS-сигнал в помещении**
3. **Слишком строгие фильтры** (исправлено)
4. **Проблемы с браузером/устройством**
5. **Блокировка геолокации антивирусом/файрволом**

## Следующие шаги
Если проблема сохраняется после этих исправлений, рассмотрите:
1. Добавление fallback на IP-геолокацию
2. Использование более продвинутых GPS-библиотек
3. Реализацию оффлайн-режима с последующей синхронизацией